newSequences <- fread("C:/Users/raiss/Downloads/BVBRC_genome.csv")
newdata <- matrix(data = NA, nrow = 0, ncol = 8)
newSequences <- fread("C:\Users\raiss\Downloads\BVBRC_genome.csv")
View(newdata)
View(newdata)
if (!require("dplyr")){
install.packages("dplyr")
require(dplyr)
}
newSequences <- fread("C:\\Users\\raiss\\Downloads\\BVBRC_genome.csv")
newSequences <- fread("C://Users//raiss//Downloads//BVBRC_genome.csv")
newdata <- matrix(data = NA, nrow = 0, ncol = 8)
#GI;acession;strain;collection_date;country;note;gene;Length;Sequences
colnames(newdata) <- c("acession", "isolate", "collection_date", "geo_loc_name", "isolation_source", "host", "segment", "Length")
newdata <- as.data.frame(newdata)
for(i in 1:nrow(newSequences)){
sequence <- entrez_fetch(db = "nuccore", id = "PQ425815", rettype="gb", retmode = "xml")
sequence_list <- XML::xmlToList(sequence)
newdata[i, ] <- NA
newdata$acession[i] <- sequence_list[["GBSeq"]][["GBSeq_primary-accession"]]
newdata$Length[i] <- sequence_list[["GBSeq"]][["GBSeq_length"]]
# newdata[i,"Sequences"] <- toupper(sequence_list[["GBSeq"]][["GBSeq_sequence"]])
for (j in 1:length(sequence_list[["GBSeq"]][["GBSeq_feature-table"]][["GBFeature"]][["GBFeature_quals"]])){
temp <- sequence_list[["GBSeq"]][["GBSeq_feature-table"]][["GBFeature"]][["GBFeature_quals"]][j]
if (temp$GBQualifier$GBQualifier_name == "isolate"){
newdata[i,"isolate"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "isolation_source"){
newdata[i,"isolation_source"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "segment"){
newdata[i,"segment"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "host"){
newdata[i,"host"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "collection_date"){
newdata[i,"collection_date"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "geo_loc_name"){
newdata[i,"geo_loc_name"] <- temp$GBQualifier$GBQualifier_value
}
}
#Coletar a sequencia e salvar
t <- read.GenBank("PQ425815")
write.FASTA(t, file = "PQ425815.fasta")
cat(i, newSequences[i], "\n")
}
#Coletar a sequencia e salvar
t <- read.GenBank("PQ425815")
#Coletar a sequencia e salvar
t <- read.GenBank(newSequences$GenBank Accessions[i])
#Coletar a sequencia e salvar
t <- read.GenBank("PQ425815")
#Coletar a sequencia e salvar
t <- read.GenBank("PQ425815")
#Coletar a sequencia e salvar
t <- read.GenBank("PQ425815")
#Coletar a sequencia e salvar
t <- read.GenBank("PQ425815")
}
newdata <- as.data.frame(newdata)
for(i in 1:nrow(newSequences)){
sequence <- entrez_fetch(db = "nuccore", id = "PQ425815", rettype="gb", retmode = "xml")
sequence_list <- XML::xmlToList(sequence)
newdata[i, ] <- NA
newdata$acession[i] <- sequence_list[["GBSeq"]][["GBSeq_primary-accession"]]
newdata$Length[i] <- sequence_list[["GBSeq"]][["GBSeq_length"]]
# newdata[i,"Sequences"] <- toupper(sequence_list[["GBSeq"]][["GBSeq_sequence"]])
for (j in 1:length(sequence_list[["GBSeq"]][["GBSeq_feature-table"]][["GBFeature"]][["GBFeature_quals"]])){
temp <- sequence_list[["GBSeq"]][["GBSeq_feature-table"]][["GBFeature"]][["GBFeature_quals"]][j]
if (temp$GBQualifier$GBQualifier_name == "isolate"){
newdata[i,"isolate"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "isolation_source"){
newdata[i,"isolation_source"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "segment"){
newdata[i,"segment"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "host"){
newdata[i,"host"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "collection_date"){
newdata[i,"collection_date"] <- temp$GBQualifier$GBQualifier_value
}
if (temp$GBQualifier$GBQualifier_name == "geo_loc_name"){
newdata[i,"geo_loc_name"] <- temp$GBQualifier$GBQualifier_value
}
}
#Coletar a sequencia e salvar
t <- read.GenBank("PQ425815")
write.FASTA(t, file = "PQ425815.fasta")
cat(i, newSequences[i], "\n")
}
install.packages(newSequences)
install.packages("newSequences")
install.packages("packagename")
ins
install.packages("ape")
q()
